-DEFAULTH &DECSEP=., &OUTSEP=,;

-DEFINE FILE SALES
    CUSTOMER_ID/A10 = CUSTOMER_ID;
    SALE_DATE/D10 = SALE_DATE;
    AMOUNT/I8 = AMOUNT;
END

-DEFINE FILE CUSTOMERS
    CUSTOMER_ID/A10 = CUSTOMER_ID;
    CUSTOMER_NAME/A50 = CUSTOMER_NAME;
END

-SET &START_DATE = '2023-01-01';
-SET &END_DATE = '2023-12-31';

-MAINTAIN SALES
    SUM AMOUNT AS TOTAL_SALES
    BY CUSTOMER_ID
    WHERE SALE_DATE GE &START_DATE AND SALE_DATE LE &END_DATE
    ON TABLE HOLD AS SALES_REPORT
END

-MAINTAIN CUSTOMERS
    PRINT CUSTOMER_ID
    PRINT CUSTOMER_NAME
    ON TABLE HOLD AS CUSTOMER_INFO
END

-FOCUS
TABLE FILE SALES_REPORT
    SUM TOTAL_SALES AS GRAND_TOTAL
    BY CUSTOMER_ID
    ACROSS CUSTOMER_NAME
    ON TABLE SET PAGE-NUM NOLEAD
    ON TABLE SET STYLE *
    TYPE=DATA, COLUMN=GRAND_TOTAL, COLUMN-TOTAL-FORMAT=$ZZ,ZZZ,ZZZ.99, $
    TYPE=REPORT, REPORT=SALES_REPORT, JUSTIFY=LEFT, $
END
